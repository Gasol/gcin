Add -Wl,--as-needed
---
 configure      |    5 +++--
 qt-im/Makefile |    2 +-
 2 files changed, 4 insertions(+), 3 deletions(-)

--- a/configure
+++ b/configure
@@ -235,7 +235,7 @@
 
 OPTFLAGS="-g"
 if [ $prefix = /usr ]; then
-  OPTFLAGS="-O"
+  OPTFLAGS="-g -O2"
 fi
 
 if [ -z $CC ]; then
@@ -258,7 +258,7 @@
 echo "libdir=\$(DESTDIR)$libdir" >> config.mak
 echo "gcinlibdir=\$(libdir)/gcin" >> config.mak
 echo "includedir=\$(DESTDIR)$includedir" >> config.mak
-echo "LDFLAGS=$GTKLDFLAGS -lX11" >> config.mak
+echo "LDFLAGS=-Wl,--as-needed $GTKLDFLAGS -lX11" >> config.mak
 echo "GCIN_VERSION=$GCIN_VERSION" >> config.mak
 echo "GCIN_TABLE_DIR=\$(datadir_r)/gcin/table" >> config.mak
 echo "GCIN_OGG_DIR=\$(datadir_r)/gcin/ogg" >> config.mak
--- a/qt-im/Makefile
+++ b/qt-im/Makefile
@@ -7,6 +7,7 @@
 OBJS=qgcininputcontextplugin.o qgcininputcontextplugin_my.o qgcininputcontext.o qgcininputcontext_x11.o
 .SUFFIXES:	.c .cpp .a .so .E .h
 LDFLAGS=-L../im-client -lgcin-im-client -Wl,-rpath,$(gcinlibdir) `pkg-config qt-mt --libs`
+LDFLAGS:=-Wl,--as-needed $(LDFLAGS)
 all:	libqgcin.so
 
 .cpp.E:
--- a/qt4-im/Makefile
+++ b/qt4-im/Makefile
@@ -9,6 +9,7 @@
 OBJS= moc_gcin-qt.o gcin-qt.o im-gcin-qt.o gcin-imcontext-qt.o
 .SUFFIXES:	.c .cpp .a .so .E .h
 LDFLAGS=-L../im-client -lgcin-im-client -Wl,-rpath,$(gcinlibdir) `pkg-config QtCore QtGui --libs`
+LDFLAGS:=-Wl,--as-needed $(LDFLAGS)
 all:    im-gcin.so
 
 .cpp.E:
